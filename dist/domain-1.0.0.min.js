/**
* @module core
*//**
* Core class
*
* @class Core
* @constructor
* @requires merge
*/
var Core=function(){var a=require("../utils/merge").merge,b=require("../node_modules/querystring").querystring;this.extend=function(b){return a(this,b)}};exports.Core=Core;var Event=function(a){var b=require("./core").Core;b.apply(this,arguments);var c=new Date;this.type="",this.campaign_id="",this.ad_id="",this.space_id="",this.site_id="",this.page_url="",this.date="",this.time="",this.hour="",this.ip="",this.browser="",this.getFullDate=function(){return typeof c=="object"?(c=c.toISOString(),c):c};var d=function(b){b=b.extend(a)}(this)};Event.required=["type","campaign_id","space_id","page_url","page_id"],Event.track=function(a){return(new Event(a)).save()},Event.prototype.getDate=function(){return this.getFullDate().split("T")[0]},Event.prototype.getTime=function(){return this.getFullDate().split("T")[1]},Event.prototype.getHour=function(){return this.time?this.time.split(":")[0]:!1},Event.prototype.validate=function(){for(var a=0;a<Event.required.length;a++){var b=Event.required[a];if(!this[b])return!1}return!0},Event.prototype.toQuery=function(){var a=require("../node_modules/querystring").querystring;return a.stringify(this)},Event.prototype.save=function(){throw new Error("You should override this")},exports.Event=Event;var Ad=function(a){var b=require("./core").Core,c=require("../node_modules/events").events.EventEmitter;b.apply(this,arguments),c.apply(this,arguments),this.id="",this.name="",this.campaign_id="",this.type="",this.file="",this.link="",this.status=!0,this.alternative={};var d=function(b){b=b.extend(a)}(this)};exports.Ad=Ad;var ISpaceBehaviour=function(){this.getAd=function(a){throw new Error("Implement it")}};exports.ISpaceBehaviour=ISpaceBehaviour;var RandomSpaceBehaviour=function(){this.getAd=function(a){var b=a.ads,c=b.length,d=Math.floor(Math.random()*c),e=b[d];return b.splice(d,1),e}},Space=function(a){var b=require("./core").Core;b.apply(this,arguments),this.id="",this.type="",this.status="",this.ads=[],this.behaviour={},this.setBehaviour=function(a){return this.behaviour=a,this.behaviour},this.getAd=function(){return this.behaviour.getAd(this)};var c=function(b){b=b.extend(a),b.setBehaviour(new RandomSpaceBehaviour)}(this)};exports.Space=Space;var Page=function(a){var b=require("./core").Core;b.apply(this,arguments),this.id="",this.name="",this.spaces=[],this.status=!0;var c=function(b){b=b.extend(a)}(this)};Page.prototype.getActiveContent=function(){return this.spaces&&this.spaces.length>=1&&(this.spaces=this.spaces.map(function(a){return a.ads&&a.ads.length>=1&&(a.ads=a.ads.filter(function(a){return a.status})),a})),this},exports.Page=Page;var Site=function(a){var b=require("./core").Core;b.apply(this,arguments),this.id="",this.name="",this.status=!0,this.domains=[];var c=function(b){b=b.extend(a)}(this)};Site.prototype.hasDomain=function(a){function d(a,b){return b.indexOf(a)!==-1}var b=this,c=!1;return d(a,this.domains)?c=!0:this.domains.forEach(function(b){var e=d("*",b);e&&(b=b.replace("*",""),d(b,a)&&(c=!0))}),c},exports.Site=Site